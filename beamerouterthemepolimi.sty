\mode<presentation>

% Header.
\defbeamertemplate*{frametitle}{polimi}
{
    \begin{tikzpicture}[overlay, remember picture]
    \node at ([shift={(1, -0.35)}] current page.north west) [anchor=north west, inner sep=0pt]
    {
        {\small \insertsection \ifx\insertsubsection\empty\else\ - \insertsubsection\fi\leavevmode}
    };
    \node at ([shift={(1, -0.85)}] current page.north west) [anchor=north west, inner sep=0pt]
    {
        \insertframetitle
    };
    \end{tikzpicture}
    \vspace{1.1cm}
}

% Use frametitle template even if \frametitle is empty.
\patchcmd{\endbeamer@frameslide}{\ifx\beamer@frametitle\@empty}{\iffalse}{}{\errmessage{failed to patch}}

\defbeamertemplate{headline}{page number}
{
    \ifnum\c@framenumber>1
        \vspace{5px}
        \setbeamertemplate{footline}[page number]
        \usebeamertemplate{footline}
    \fi
}

\setbeamertemplate{headline}[page number]

% Footer.
\defbeamertemplate{footline}{polimi}{
    \begin{minipage}[b][1cm][c]{\paperwidth}
        \ifnum\c@framenumber>1
            \hspace{1.5mm}
            {\small\color{white}\insertauthor}
            \hspace*{\fill}
            \includegraphics[height=7px]{logo_bandiera.png}
            \hspace{1.5mm}
        \fi
    \end{minipage}
}

\setbeamertemplate{footline}[polimi]

\mode<all>
